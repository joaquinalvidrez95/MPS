<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"                    
             xmlns:behaviour="clr-namespace:MPS.Behaviour;assembly=MPS"
             xmlns:viewModel="clr-namespace:MPS.ViewModel;assembly=MPS"
             Title="Mensajes"
             Style="{StaticResource PaddingContentPage}"
             x:Class="MPS.MessagePage">

    <ContentPage.Resources>
        <ResourceDictionary>
            <viewModel:MessagePageModel x:Key="ViewModel" />
            <Style TargetType="Button">
                <Setter Property="BackgroundColor"
                        Value="Red"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.Content>
        <StackLayout BindingContext="{StaticResource ViewModel}">
            <!--<Editor Text="{Binding Message}"
                HeightRequest="100"/>-->
        
            <Button
                Command="{Binding MessagePopupCommand}"
                HorizontalOptions="Center"           
                Image="ic_add_white_48dp.png"/>
            <ListView ItemsSource="{Binding Messages}"
                      SelectedItem="{Binding SelectedItem}"
                      behaviour:ItemTappedAttached.Command="{Binding ItemTappedCommand}"
                      Header="Mensajes"
                      HasUnevenRows="True">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>
                            <ViewCell.View>
                               
                                <StackLayout Orientation="Horizontal">
                                    <Label Text="{Binding Title}"
                                           VerticalOptions="Center"
                                           HorizontalOptions="StartAndExpand" />
                                    <Image Source="ic_delete_forever_black_48dp.png"
                                           VerticalOptions="Center"
                                           HorizontalOptions="End">
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding Source={StaticResource ViewModel}, Path=DeleteCommand}"
                                                                  CommandParameter="{Binding Title}"/>
                                        </Image.GestureRecognizers>
                                    </Image>

                                    <Image Source="ic_send_envelope.png"
                                               VerticalOptions="Center"
                                               HorizontalOptions="End">
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding Source={StaticResource ViewModel}, Path=SendCommand}"
                                                                  CommandParameter="{Binding Title}"/>
                                        </Image.GestureRecognizers>
                                    </Image>
                                                             
                                </StackLayout>

                            </ViewCell.View>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackLayout>
    </ContentPage.Content>
</ContentPage>